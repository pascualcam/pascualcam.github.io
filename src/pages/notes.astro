---
import Layout from "../layouts/Layout.astro";
import Sidebar from "../components/sections/Sidebar";
import { getCollection } from "astro:content";

// Get all notes from the content collection
const notes = await getCollection("notes");
// Sort by date (newest first)
notes.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime(),
);
---

<Layout
  title="Notes - Pascual Camacho"
  description="Notes and thoughts on technology and development"
>
  <Sidebar slot="sidebar" client:load />

  <main class="min-h-screen py-12">
    <div class="max-w-3xl mx-auto px-6">
      <div class="mb-8">
        <h1
          class="text-xl font-normal tracking-tight text-primary-900 dark:text-primary-100 mb-2"
        >
          Notes
        </h1>
      </div>

      <div class="space-y-6">
        {
          notes.length > 0 ? (
            <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
              {notes.map((note) => (
                <article class="border border-primary-200/20 dark:border-dark-700/20 rounded-sm p-4 hover:bg-primary-100/40 dark:hover:bg-dark-800/40 transition-all duration-300">
                  <div class="mb-3">
                    <h2 class="text-sm font-normal text-primary-800 dark:text-primary-200 mb-1">
                      {note.data.title}
                    </h2>
                    <p class="text-primary-500 dark:text-primary-400 text-xs mb-2">
                      {note.data.description}
                    </p>
                    <div class="flex items-center justify-between">
                      <time class="text-primary-400 text-xs tracking-wide">
                        {new Date(note.data.date).toLocaleDateString()}
                      </time>
                      {note.data.tags && note.data.tags.length > 0 && (
                        <div class="flex gap-1">
                          {note.data.tags.slice(0, 2).map((tag) => (
                            <span class="bg-primary-100/30 dark:bg-dark-800/30 text-primary-500 dark:text-primary-400 text-xs px-1.5 py-0.5 rounded-sm">
                              {tag}
                            </span>
                          ))}
                        </div>
                      )}
                    </div>
                  </div>
                  <a
                    href={`/notes/${note.slug}`}
                    class="text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-200 text-xs font-normal italic"
                  >
                    Read more â†’
                  </a>
                </article>
              ))}
            </div>
          ) : (
            <section>
              <h2 class="text-sm font-normal italic text-primary-600 dark:text-primary-400 mb-4">
                Coming Soon
              </h2>
              <div class="border border-primary-200/20 dark:border-dark-700/20 rounded-sm p-6 text-center">
                <p class="text-primary-500 dark:text-primary-400 text-sm mb-3">
                  This section will contain notes about technology, development,
                  and other interesting topics.
                </p>
                <p class="text-primary-400 text-xs">
                  In development...
                </p>
              </div>
            </section>
          )
        }
      </div>
    </div>
  </main>
</Layout>
